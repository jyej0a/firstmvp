# [PRD] Trend-Hybrid Admin: 통합 기획서 (Final)

| 문서 정보        | 내용                            |
| ---------------- | ------------------------------- |
| **문서 버전**    | v4.1 (KPI 조정: 1분당 1개 수집) |
| **작성일**       | 2025-11-30                      |
| **최종 수정**    | 2025-12-22                      |
| **작성자**       | PM (사용자)                     |
| **MVP 1.0 목표** | 2026-01-10                      |
| **v1.1 목표**    | 2026-01-24                      |
| **상태**         | **최종 확정 (Approved)**        |

## 1. 서비스 개요 (Service Overview)

- **프로젝트 명:** **Trend-Hybrid Admin (트렌드-하이브리드 어드민)**
- **한 줄 소개:** 틱톡 바이럴로 검증된 상품을 아마존 데이터로 교차 확인하고, 타오바오 원가로 소싱하여 Shopify에 등록하는 **트렌드 헌팅 자동화 솔루션**.
- **기획 배경 & 문제 정의:**
  - **Market Logic:** "틱톡 조회수 급상승 → 아마존 키워드 검색량 폭발"이라는 필승 공식이 존재하지만, 1인 셀러가 이 속도를 따라잡기는 불가능함.
  - **Speed Gap:** 트렌드를 발견하고 소싱/등록하는 사이 이미 유행이 지나거나 대형 셀러가 시장을 장악함.
  - **Sourcing Gap:** 트렌드 상품(미국)과 제조 원가(중국) 사이의 정보 비대칭으로 인한 마진 확보의 어려움.
- **타겟 사용자:** 트렌드 사이클(Viral Cycle)을 타서 단기간에 고수익을 노리는 **'스피드 위주의 1인 셀러'**.
- **사용자 주요 니즈:** "틱톡에서 뜨는 거 봤어? 그거 아마존에 검색해서 데이터 확인하고 바로 내 샵에 깔아줘."

## 2. 목적 및 핵심 가치 (KPI)

- **사용자 가치:**
  - **Trend-Data Sync:** 틱톡(감성/바이럴)과 아마존(이성/구매) 데이터를 연결하여 **'팔릴 수밖에 없는 상품'**만 취급.
  - **Time-to-Market:** 안정적인 수집으로 많은 양을 등록하는 것이 목표. 대기 시간 증가는 중요하지 않음 (하루종일 켜두면 됨).
- **핵심 지표 (KPI):**
  - **MVP 1.0 (2026-01-10)**
    1. **소싱 속도:** 카테고리 입력 후 **1분당 1개씩** 수집. 하루 최대 **1000개** 수집 가능 (약 16.7시간 소요). Bot Detection 회피를 위한 안정적인 속도.
    2. **매칭 효율:** 타오바오 이미지 검색 연동 클릭 수 **1회**.
    3. **등록 성공률:** 사용자 최종 승인 후 Shopify 등록 성공률 **95% 이상**.
  - **v1.1 (2026-01-24)**
    1. **소싱 속도:** **1분당 1개씩** 수집 유지 (하루 최대 1000개).
    2. **등록 성공률:** **99% 이상**으로 개선.

## 3. 주요 기능 정의 (Core Features)

| 기능명                          | 버전    | 우선순위     | 상세 정의                                                                                                                                                                                   |
| ------------------------------- | ------- | ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **트렌드 소싱 숏컷**            | MVP 1.0 | **Must**     | 대시보드 내에서 Kalodata, Amazon Best Sellers 등 트렌드 분석 사이트로 즉시 이동하여 '검증된 상품'을 발굴하도록 지원.                                                                        |
| **트렌드 데이터 수집기**        | MVP 1.0 | **Must**     | 검증된 상품의 카테고리/URL 입력 시 고품질 콘텐츠(제목, 이미지, 옵션 등) **1분당 1개씩 순차 수집** (30개 수집 시 약 30분). 수집된 상품은 즉시 DB 저장 및 UI 업데이트. (v1.1에서 50개로 확장) |
| **데이터 관리 대시보드**        | MVP 1.0 | **Must**     | 수집 데이터 확인 및 체크박스 선택, 마진율 기반 판매가 자동 계산 UI 제공.                                                                                                                    |
| **IP/금지어 필터링**            | MVP 1.0 | **Must**     | 브랜드명 등 금지어 포함 시 수집 단계에서 자동 차단(Drop).                                                                                                                                   |
| **타오바오 이미지 검색 브릿지** | MVP 1.0 | **Must**     | 상품 이미지 클릭 시, 타오바오 이미지 검색 결과 페이지로 새 탭 연결 (원가 수동 확인 지원).                                                                                                   |
| **US 타입 가격 계산**           | MVP 1.0 | **Must**     | 아마존 가격 기반 마진율 자동 계산 (공식: `amazonPrice × (1 + marginRate)`).                                                                                                                 |
| **Shopify 일괄 등록**           | MVP 1.0 | **Must**     | 수집된 상품은 즉시 등록 가능. 순차 처리 방식: 1개 수집 → 등록 완료 → 다음 수집 진행. 체크박스로 선택된 상품들을 Shopify 스토어에 API로 일괄 전송 (이미지 업로드 포함).                      |
| **CN 타입 가격 계산**           | MVP 1.0 (Phase 2.5) | **Must**     | 타오바오 원가 기반 마진 자동 계산 로직 추가 (공식: `(costPrice + shipping + extra) / (1 - marginRate)`). Phase 2.5에서 구현 예정.                                                                                    |
| **스크래핑 요소 추가**         | MVP 1.0 (Phase 2.5) | **Must**     | 리뷰수, 평점 등 추가 요소 수집. Phase 2.5에서 구현 예정.                                                                                                                                         |
| **수집 중지 및 재개**          | MVP 1.0 (Phase 2.5) | **Must**     | 수집 진행 중 일시 중지 가능, 재개 시 이어서 수집 또는 처음부터 다시 수집 선택 가능. Phase 2.5에서 구현 예정.                                                                                    |
| **50개 수집 확장**              | v1.1    | Should       | 30개에서 50개로 수집 확장 및 진행 상황 실시간 표시.                                                                                                                                         |
| **중국어 이미지 필터링**        | v1.1    | Should       | 이미지에 중국어 텍스트 포함 여부 자동 감지 및 필터링.                                                                                                                                       |
| **Toast 알림 시스템**           | v1.1    | Nice to Have | 성공/에러/경고 메시지를 사용자 친화적으로 표시.                                                                                                                                             |
| **반응형 디자인**               | v1.1    | Nice to Have | 모바일 환경에서도 사용 가능하도록 UI 최적화.                                                                                                                                                |

## 4. 화면 설계 (UX/UI Design)

### 4.1. 전체 사용자 플로우 (User Flow)

- **상세 Flow Chart:** 별첨 파일 `User_Flow.mmd` 참조.
- **Flow 요약:** **트렌드 발견(틱톡)** → **아마존 검증(크로스 체크)** → **50개 리스트업** → 이미지 클릭(타오바오 검색) & 원가 입력 → 체크박스 선택 → **일괄 등록**.

### 4.2. 핵심 화면 와이어프레임 (Wireframes)

### **A. 메인 대시보드 & 수집 화면 (Main Dashboard)**

```
+---------------------------------------------------------------+
| ☰ Menu   Trend-Hybrid Admin              [Admin ▼] [Settings]|
+---------------------------------------------------------------+
| [ 🚀 Quick Links ]                                            |
|   ( 🔗 Kalodata ) ( 📦 Amazon BSR ) ( 💡 Idea Backlog )      |
+---------------------------------------------------------------+
|                                                               |
|        [ 메인 액션 ] 키워드 또는 URL 입력 & 일괄 수집            |
|                                                               |
| +---------------------------------------------------------+   |
| | 🔍 키워드 입력 또는 Amazon URL 붙여넣기... [수집 시작] 버튼  |   |
| +---------------------------------------------------------+   |
|                                                               |
| [x] 금지어 자동 필터링 적용 (ON)    [x] 50개 상품 Max 수집   |
+---------------------------------------------------------------+
|                                                               |
| 📋 수집 목록 (48 items) - [선택 등록 (0)] 버튼              |
|                                                               |
| [ Select ] | Image | Title... | Type | Cost | Price | Status |
| ----------+-------+----------+------+------+-------+--------|
| [v]        | [ 🖼️ ] | 진동 운동... | [CN ▼]| [$ 5]| $18.3 | Ready  |
| [ ]        | [ 🖼️ ] | 고양이 밥그릇| [US ▼]| [- ] | $45.0 | Ready  |
| [v]        | [ 🖼️ ] | 스마트 훌라..| [CN ▼]| [$ 3]| $15.0 | Ready  |
+---------------------------------------------------------------+

```

### **B. 상세 편집 & 가격 설정 화면 (Editor/Pricing)**

```
+---------------------------------------------------------------+
|  < 목록으로 돌아가기      상품 상세 편집 (Vibration Platform)  |
+---------------------------------------------------------------+
| [ Left: 아마존 콘텐츠 ]        | [ Right: 가격/소싱 컨트롤 ]      |
|                                |                                |
| [ 이미지 갤러리 슬라이더 ]       | 💰 가격 계산기                 |
|   (중국어 이미지 제외 체크박스)  | - Cost (원가):    [ $ 8.00 ]  |
|                                | - Shipping:    [ $ 5.00 ]  |
| [ 상품명 (수정 가능) ]         | - Tax/Extra:   [ $ 2.00 ]  |
|                                | - Margin (%):  [ 40 % ]    |
| [ 상세설명 텍스트 박스 ]       | ------------------------------ |
|   (Bullet points)              | - Final Price: [ $ 25.00 ] (자동)|
|                                |                                |
| [ 옵션 목록 (확인용) ]         | ⚙️ 등록 설정                   |
|   - Color: Black, Red, Blue    | [v] Shopify에 Active 상태로 등록|
|                                | [ Shopify 등록 ] 버튼          |
+---------------------------------------------------------------+

```

### 4.3. 화면별 기능 명세 (Functional Specs)

### **A. 공통 기능 및 메인 화면 명세**

| UI 요소             | 기능 설명                               | 입력값 (Input)         | 로직 & 예외 처리 (Logic/Exception)                                                                                                                                                                          |
| ------------------- | --------------------------------------- | ---------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Trend Shortcuts** | 외부 트렌드 사이트 새 탭 열기           | -                      | 단순 링크 이동 (`target="_blank"`)                                                                                                                                                                          |
| **검색 Input**      | 키워드 또는 Amazon URL 입력             | `string` (Keyword/URL) | • **키워드 입력 시:** 시스템이 자동으로 Amazon 검색 URL 생성 (예: "neck device" → `amazon.com/s?k=neck+device`). • **URL 입력 시:** `amazon.com` 도메인 체크 후 그대로 사용. • 빈 값 입력 시 버튼 비활성화. |
| **수집 버튼**       | 스크래퍼 트리거 (1분당 1개씩 순차 수집) | `onClick`              | • **Loading:** 클릭 시 "수집 중... (30개 중 5개 완료)" 진행률 표시.                                                                                                                                         |

• **실시간 업데이트:** 수집된 상품은 즉시 DB 저장 및 UI 업데이트.

• **순차 처리:** 1개 수집 → 등록 완료 → 다음 수집 진행.

• **진행 상황:** "수집 중... 30개 중 5개 완료, 예상 남은 시간: 25분" 표시. |
| **중지 버튼**       | 수집 작업 일시 중지                     | `onClick`              | • **중지:** 진행 중인 수집 작업을 일시 중지 (paused 상태). 중지된 작업은 나중에 재개 가능.                                                                                                                |
| **재개 버튼**       | 중지된 수집 작업 재개                   | `onClick` + 선택 옵션   | • **이어서 수집:** 현재 진행 상황(`currentCount`) 유지하고 중지된 지점부터 계속 수집.                                                                                                                      |

• **처음부터 다시:** `currentCount`, `successCount`, `failedCount` 초기화 후 처음부터 다시 수집. |
| **선택 등록 버튼** | 선택된 상품 Shopify API 일괄 전송 | `selected_product_ids` (Array) | **가장 중요:** CN 타입 상품의 `Cost`가 0일 경우, "원가 미입력 상품 존재" 경고 팝업 후 진행 불가. |

### **B. 작업대 리스트 및 편집 화면 명세**

| UI 요소               | 기능 설명                       | 입력값 (Input) | 로직 & 예외 처리 (Logic/Exception)                  |
| --------------------- | ------------------------------- | -------------- | --------------------------------------------------- |
| **Image (Clickable)** | **타오바오 이미지 검색 브릿지** | `image_url`    | • 클릭 시 **타오바오 이미지 검색 결과** 새 탭 오픈. |

• 이미지 깨짐 시 대체 이미지 표시. |
| **Type Select** | 소싱처 유형 선택 (US/CN) | `source_type` (Enum) | • **CN 선택 시:** `Cost` 입력창 활성화 (필수 입력으로 간주).

• **US 선택 시:** `Cost` 비활성화. |
| **Cost Input** | 타오바오 원가 입력 | `cost_price` (Number) | • 숫자만 입력 가능.

• 입력 즉시 `Selling Price` 필드 실시간 재계산 (`onChange` 이벤트). |
| **Margin (%)** | 희망 마진율 설정 | `margin_rate` (Number) | 0~100 사이 값만 허용. |
| **Final Price** | 최종 판매가 표시 (Read-only) | - | 공식: `(Cost + $5 + $2) / (1 - Margin)` (기본값 적용). |

## 5. 기술 요구사항 (Technical Specs)

- **데이터 항목:**
  - `Title` (Text), `ASIN` (String, Unique), `Images` (Array[URL]), `Variants` (Array[Text]), `Description` (HTML/Text), `Cost_Price` (Float), `Selling_Price` (Float), `Sourcing_Type` (Enum: US/CN).
- **외부 API 활용:**
  - **Shopify Admin API:** 상품 생성(Create Product) 및 이미지 업로드.
  - **Clerk Auth API:** 사용자 인증 관리 (Whitelist).
- **DB 구조 (Supabase):** 
  - `products` 테이블 (기본 상품 정보, 가격, 상태 등)
  - `banned_keywords` 테이블 (금지어 목록)
  - `scraping_jobs` 테이블 (순차 처리 Job 관리, Phase 2.5)
  - `scraping_job_items` 테이블 (Job별 상품 아이템, Phase 2.5)
- **순차 처리 시스템 (Phase 2.5):**
  - Job 기반 비동기 처리 (1분당 1개씩 수집)
  - 진행 상황 실시간 조회 (Polling 방식)
  - 에러 처리 및 재시도 로직
  - 하루 최대 1000개 수집 지원
  - Job 상태: `pending`, `running`, `paused`, `completed`, `failed`, `cancelled`
  - 중지 및 재개 기능: PATCH `/api/scrape/[jobId]` (action: `pause` | `resume` | `restart`)
  - 재개 옵션: `continue` (이어서 수집, `currentCount` 유지) 또는 `restart` (처음부터 다시, 카운트 초기화)
- **가격 계산 시스템:**
  - US 타입: `amazonPrice × (1 + marginRate / 100)`
  - CN 타입: `(costPrice + shipping + extra) / (1 - marginRate / 100)` (Phase 2.5)
- **스크래핑 요소 (Phase 2.5):**
  - 리뷰수, 평점 등 추가 데이터 수집
  - DB 스키마 확장 (`review_count`, `rating` 컬럼)
- **Tech Stack:** Next.js 14, Puppeteer (Scraping), Tailwind CSS.

## 6. 경쟁 서비스 분석 (비교 우위)

| 비교 항목         | **Trend-Hybrid Admin (자사)**                                                                            | **Minea / Pipiads (트렌드 툴)**                | **DSers / CJ Drop (소싱 툴)**                             |
| ----------------- | -------------------------------------------------------------------------------------------------------- | ---------------------------------------------- | --------------------------------------------------------- |
| **핵심 기능**     | **트렌드 발견 → 데이터 검증 → 소싱 연결 → 등록 (All-in-One)**                                            | 틱톡/FB 광고 스파이, 바이럴 영상 찾기          | 알리익스프레스 상품 연동 및 배송 처리                     |
| **한계점**        | 초기엔 트렌드 발견을 외부 툴에 의존해야 함                                                               | **상품 등록 기능 없음**, 소싱처 직접 찾아야 함 | **'무엇을 팔아야 할지'** 알려주지 않음 (트렌드 파악 불가) |
| **차별화 포인트** | **"틱톡에서 본 걸 아마존 데이터로 확인하고 타오바오 가격으로 1분 만에 런칭한다"**는 완결된 프로세스 제공 | -                                              | -                                                         |

## 7. MVP 1.0 vs v1.1 로드맵

### MVP 1.0 (2026-01-10 런칭)

**목표:** 최소 기능으로 빠르게 검증

| 구분          | 내용                                                       |
| ------------- | ---------------------------------------------------------- |
| **수집 개수** | 하루 최대 1000개 (1분당 1개씩 순차 수집, 약 16.7시간 소요) |
| **가격 계산** | US 타입 (아마존 가격 기반), CN 타입 (Phase 2.5 완료 후)    |
| **타오바오**  | 이미지 검색 브릿지 (수동 원가 확인, Phase 2.5에서 재구현)  |
| **스크래핑 요소** | 리뷰수, 평점 등 추가 요소 (Phase 2.5)                      |
| **Shopify**   | 체크박스 선택 후 일괄 등록                                 |
| **UX**        | 기본 로딩/에러 처리                                        |
| **타겟**      | 데스크톱 환경                                              |

### v1.1 (2026-01-24 런칭)

**목표:** 사용자 피드백 반영 및 기능 확장

| 구분                  | 내용                                                               |
| --------------------- | ------------------------------------------------------------------ |
| **수집 개수**         | 50개 (1분당 1개씩 순차 수집, 약 50분 소요) + 진행 상황 실시간 표시 |
| **가격 계산**         | US/CN 타입 선택 가능 (CN 타입은 Phase 2.5에서 먼저 구현)           |
| **이미지 필터**       | 중국어 이미지 자동 필터링                                          |
| **Shopify 등록 품질** | 카테고리 자동 설정, 이미지 중복 제거                               |
| **UX**                | Toast 알림, 상세 편집 기능                                         |
| **반응형**            | 모바일 대응                                                        |

> ⚠️ **알려진 개선 사항** (2024-12-09 테스트 결과):
>
> - **카테고리 미설정**: 현재 모든 상품이 "General"로 등록됨 → v1.1에서 아마존 카테고리 기반 자동 매핑 구현
> - **이미지 중복**: 동일 이미지가 4-5개씩 중복 등록됨 → v1.1에서 중복 제거 로직 추가

---

## 8. 사용자 시나리오

### MVP 1.0 시나리오

**김셀러**는 틱톡에서 '목 교정기' 영상 조회수가 급증하는 것을 발견한다(1단계).

아마존에 'Neck Traction Device'를 검색하여 베스트셀러 URL을 Trend-Hybrid Admin에 입력한다(2단계).

**1분당 1개씩** 상품이 수집되며, 수집된 상품은 즉시 대시보드에 표시된다. 하루 최대 **1000개**까지 수집 가능하며 (약 16.7시간 소요), 수집 과정에서 리뷰가 좋은 상품의 이미지를 클릭하여 타오바오 검색으로 넘어가 원가($3)를 확인한다(3단계).

대시보드에서 마진율 40%를 입력하면 판매가($41.6)가 자동 계산된다. 아마존 판매가($29) 대비 충분한 마진을 확인하고, 원하는 상품들을 체크한 후 '선택 등록'을 눌러 Shopify에 등록한다(4단계). 수집과 등록은 순차적으로 진행되며, 수집된 상품은 즉시 등록 가능하다.

### v1.1 시나리오 (개선)

동일한 플로우에서 **50개** 상품이 수집되고, **CN 타입**을 선택하여 원가($3)를 직접 입력하면 배송비/관세를 고려한 판매가가 자동 계산된다. 또한 중국어가 포함된 이미지는 자동으로 필터링되어 Shopify 등록 시 제외된다.

## 9. 기대 효과 및 리스크

### 기대 효과

- **MVP 1.0:** 트렌드 포착부터 판매 개시까지의 **Lead Time을 며칠에서 단축**. 안정적인 수집(1분당 1개)으로 Bot Detection 위험을 최소화하고 많은 양의 상품을 등록하는 것이 목표.
- **v1.1:** 수집 개수 확장 및 CN 타입 지원으로 **소싱 옵션 다양화 및 마진 최적화**.

### 리스크 및 대응

| 리스크                        | 영향도 | 대응 방안                                                                                                                                        |
| ----------------------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| 아마존 **Bot Detection**      | 높음   | **1분당 1개 수집**으로 안정적인 속도 유지. User-Agent 설정, 랜덤 딜레이(1-3초), 요청 간격 조절. 일반 사용자 수준의 요청 빈도로 차단 위험 최소화. |
| Shopify API **Rate Limit**    | 중간   | 순차 등록 (병렬 X), 재시도 로직 (최대 3회)                                                                                                       |
| 타오바오 이미지 검색 **실패** | 낮음   | 사용자 수동 확인으로 대체 (브릿지만 제공)                                                                                                        |
| **인프라 지연** (Phase 0)     | 높음   | Phase 0 완료 전 Phase 2 시작 불가 (의존성 명시)                                                                                                  |
